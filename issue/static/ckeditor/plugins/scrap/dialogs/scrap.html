<had>
    <script type="text/javascript" src="/static/jquery.min.js"></script>
    <script type="text/javascript" src="/static/underscore-min.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="/static/storify.css"/> -->
</head>

<style>
    .scrap-title {
        font-family: "Helvetica Neue", Arial, sans-serif;
        font-size: 12px;
        font-weight: 700;
        line-height: 18px;
        margin: 0 5px 0 0;
        color: #333;
    }
    .scrap-description {
        font: 12px / 18px "Open Sans", Arial;
        font-size: 11px;
        font-family: Arial, Helvetica;
        color: #777;
    }

    .s-result {
        color: #777;
        font-size: 11px;
        line-height: 15px;
        padding: 5px
    }

    .r-element {
        list-style: none;
        padding: 0 0 3px;
        background: #fff;
        border: 1px solid #ccc;
        -webkit-box-shadow: inset 0 -3px 0 #eee;
        -moz-box-shadow: inset 0 -3px 0 #eee;
        box-shadow: inset 0 -3px 0 #eee;
    }

    .s-element.r-element .s-element-content {
        display: block
    }

    .to-comment {
        border-top: 1px solid #cccccc;
        vertical-align: middle;
        height:30px;
        line-height: 30px;
        text-align:center;
        font-size:13px;
        width:100%;
    }
</style>

<form id="form">
    URL : <input type="text" id="url" name="url" size="40"><input type="button" value="scrap" id="add_cell">
</form>
<div id="scrap-result"></div>

<script language="JavaScript">
    $('#add_cell').click(function() {
        var url = $('#url').val();
        $.ajax({
            url: '/scraper/_/scrap',
            data: ({url: url} ),
            success: function(msg) {
                msg['summary'] = '';
                msg['url'] = '';
                msg['id'] = '';
                msg['site_url'] = '';
                if (msg.images.length != 0) {
                    var templateCell = _.template($('#item-template').html());
                }
                else {
                    var templateCell = _.template($('#item-template-noimage').html());
                }
                $("#scrap-result").html(templateCell(msg));
            },
            failure: function(msg) {
                alert(msg);
            }
        });

    });
</script>
<script type="text/template" id="item-template">
<li class="r-element r-element-link">
    <div class="s-default s-result s-element-content">
        <div class="s-default-content">
            <a href="<%= url %>" target="_blank">
                <div class="scrap-title"><%=id %> <%= title %></div>
            </a>

            <div class="s-default-description"><%= summary %></div>
        </div>
        <div class="s-attribution">
            <div class="s-source"><a href="<%= url %>" target="_blank"><img src="<%= images[0]['url'] %>" style="max-width: 16px" border="0"></a></div>
            <div class="s-author"><a href="<%= url %>" target="_blank" class="s-author-name"><%= site_url %></a></div>
            <a href="<%= url %>" target="_blank" class="s-posted">
            <div class="scrap-description">no description</div>
        </a>
        </div>
        <div class="s-clear"></div>
    </div>
</li>
</script>
<script type="text/template" id="item-template-noimage">
    <div class="r-element r-element-link">
        <div class="s-default s-result s-element-content">
            <div class="s-default-content">
                <a href="<%= url %>" target="_blank">
                    <div class="scrap-title"><%=id %> <%= title %></div>
                </a>
                <div class="s-default-description"><%= summary %></div>
            </div>
            <div class="s-attribution">
                <div class="s-source"></div>
                <div class="s-author"><a href="<%= url %>" target="_blank" class="s-author-name"><%= site_url %></a></div>
                <a href="<%= url %>" target="_blank" class="s-posted">
                <div class="scrap-description">no description</div>
            </a>
            </div>
            <div class="s-clear"></div>
        </div>
    </div>
</script>
